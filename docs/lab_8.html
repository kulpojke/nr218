<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Working With DEMs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-53b9468ac95cb2fade5b249ba61a8ae1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="fullcontent">

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Working With DEMs</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Now that we’ve learned a bit about what DEMs are and what they can be used for, let’s get some practice working with them in QGIS.</p>
<p><strong>Quick file organization housekeeping:</strong></p>
<p>Make a new folder inside your <code>nr218</code> directory called <code>lab_8</code>. Inside that folder, make a <code>data</code> folder and a <code>docs</code> folder. All downloaded files will go in the <code>data</code> folder, and all generated outputs (more on this later) will go in <code>docs</code>. You should have a directory structure as shown below.</p>
<pre><code>nr218/
└── lab_8
    ├── data
    ├── docs</code></pre>
<section id="warm-up-finding-data-online" class="level2">
<h2 class="anchored" data-anchor-id="warm-up-finding-data-online">Warm Up: Finding Data Online</h2>
<p>So far in this class you’ve been given files to work with. Today, we’re going to practice acquiring some data on our own.</p>
<p>Generating DEMs, particularly at a high resolution, can be costly and time-consuming. Luckily, there are some great online resources for accessing existing imagery. One such resource is the <a href="https://www.usgs.gov/tools/lidarexplorer">USGS LiDAR Explorer</a>.</p>
<p>Follow the link above, and then click “Launch Application” to get to the interactive map (<a href="#fig-lidar1" class="quarto-xref">Figure&nbsp;1</a>).</p>
<div id="fig-lidar1" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Image showing initial map that loads when launching the USGS LiDAR Explorer Application" data-fig-cap="Startup map of LiDAR Explorer">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lidar1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/lidar_explorer_1.png" class="img-fluid figure-img" data-fig-cap="Startup map of LiDAR Explorer" alt="Image showing initial map that loads when launching the USGS LiDAR Explorer Application">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lidar1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Startup map of LiDAR Explorer
</figcaption>
</figure>
</div>
<p>You can navigate around the map by clicking and dragging with your mouse. Zooming is accomplished using your scroll wheel (or the “+” button at the top left of the map viewer, if you like your zooming to be painful). Orient your map view so that it’s centered on San Luis Obispo. There are three check boxes in the left panel. Try checking and unchecking them to see what happens.</p>
<p>Next, let’s define our <strong>area of interest</strong> (AOI). This will return all of the available LiDAR and DEM downloads within a specified geographic area. Click the <em>Define area of interest</em> box and draw a box around SLO (by holding control and dragging), then check what pops up on the right side of the screen.</p>
<div id="fig-lidar3" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Image showing what an area of interest box looks like on the map" data-fig-cap="Defined area of interest">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lidar3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/lidar_explorer_3.png" class="img-fluid figure-img" data-fig-cap="Defined area of interest" alt="Image showing what an area of interest box looks like on the map">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lidar3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Defined area of interest
</figcaption>
</figure>
</div>
<p>On the right panel, you should see dropdowns for DEM, LiDAR, and DSM/ORI products within the AOI. After we define the AOI, these dropdowns populate with all downloadable files in the area. In this case, we’re interested in what DEMs are available, so let’s expand that dropdown. As you can see, there are a lot of files! Too many! We don’t want to download that much data for this exercise, so let’s choose just one tile to download. First, click on the folder icon next to <code>DEM 1 Meter</code>. You should now see a list of individual files, like this:</p>
<div id="fig-lidar4" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Image showing the individual 1 meter DEM tiles within AIO" data-fig-cap="Individual DEM tiles">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lidar4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/lidar_explorer_4.png" class="img-fluid figure-img" data-fig-cap="Individual DEM tiles" alt="Image showing the individual 1 meter DEM tiles within AIO">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lidar4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Individual DEM tiles
</figcaption>
</figure>
</div>
<p>Choose one of the files on the list and click the download icon next to it. Once downloaded, rename the file to <code>DEM_1_meter.tif</code> and move it to <code>nr218/lab_8/data</code>.</p>
<p>Next, close the 1 meter file list (click again on the folder icon) and open the <code>30m</code> folder. Choose one of those files to download, rename it to <code>DEM_30_meter.tif</code>, and save it to <code>data</code>.</p>
<div id="tip-bathym" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;1: What is topobathy Lidar
</div>
</div>
<div class="callout-body-container callout-body">
<p>Topobathymetric lidar measures land, water, and submerged land simultaneously. Topobathymetric lidar sensors use two independent laser sources. A near infrared laser is used to map the land and surface of the water, while a visible green laser is used to penetrate the water surface and measure the bottom (in water depths of up to about five meters, depending on water clarity).</p>
</div>
</div>
<div id="tip-tiles" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;2: Building a Virtual Raster
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you wanted to use 1 meter DEMs for a project, but needed to cover a larger area, you could save on file size by downloading all of the individual tiles you needed and ‘stitching’ them together into a <code>virtual raster (VRT)</code> in QGIS. A VRT acts as a <em>catalog</em> for all selected raster files, rather than creating a new image. This can be useful for doing quick actions like reprojecting or clipping a large area of raster imagery, but you will get better overall performance using a merged TIF file.</p>
</div>
</div>
</section>
<section id="task-1-comparing-and-visualizing-dems" class="level2">
<h2 class="anchored" data-anchor-id="task-1-comparing-and-visualizing-dems">Task 1: Comparing and Visualizing DEMs</h2>
<ol type="1">
<li>Open a new project in QGIS and save it to your <code>nr218/lab_8</code> folder (NOT within one of the sub-folders).</li>
<li>Set the global CRS of the project to EPSG:26910 (UTM Zone 10N). You can do this by going to Project &gt; Properties &gt; CRS.</li>
<li>Add in a satellite basemap of your choice.</li>
<li>Add in your 1 meter DEM file. You have options on how to do this:</li>
</ol>
<ul>
<li>Click and drag the file into QGIS from your file explorer</li>
<li>Go to Layer &gt; Add Layer &gt; Add Raster Layer (You can also do this by hitting Shift + Ctrl/Cmd + R)</li>
</ul>
<ol start="5" type="1">
<li>Add in your 30 meter DEM in the same way.</li>
</ol>
<section id="comparing-dem-resolutions" class="level3">
<h3 class="anchored" data-anchor-id="comparing-dem-resolutions">Comparing DEM Resolutions</h3>
<p>Take a look at the two DEM files. If they’re not both already in EPSG:26910, reproject using Raster &gt; Projections &gt; Warp (Reproject).</p>
<p>10 and 30 meter DEMs are typically much easier to track down than 1 meter. However, what we gain in accessibility and area coverage, we give up in detail and accuracy. To illustrate this, let’s compare the elevation values between the two DEMs.</p>
<p><strong>Sampling Raster Values</strong></p>
<p>We can do this using a tool called <code>Sample Raster Values</code>. First, we’ll need to add some points to our map.</p>
<ol type="1">
<li>Go to Layer &gt; Create Layer &gt; New Temporary Scratch Layer</li>
<li>Name the layer something useful, change the geometry type to to point, and make sure the CRS is 26910. Hit <code>Ok</code>.</li>
<li>Editing should be toggled on by default, but if it’s not, click on the pencil icon. Then select <code>add point feature</code> and add ~4 points to the map (click on the map to add a point). Make sure they are on areas of overlap between both DEMs, and try to cover different levels of elevation (lighter/darker gray).</li>
</ol>
<div id="fig-feature_icon" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-feature_icon-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/add_feature_icon.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-feature_icon-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Add Feature Icon
</figcaption>
</figure>
</div>
<ol start="4" type="1">
<li>Once you’re satisfied with your points, hit the save icon (next to the pencil) and toggle editing off.</li>
</ol>
<p>Now let’s check out the <code>sample raster values</code> tool using our 1 meter DEM.</p>
<ol type="1">
<li>In the processing tools window, search for <code>sample raster values</code>.</li>
<li>Select our newly created point layer as the input, and our DEM_1_meter as the raster layer.</li>
<li>If you’d like, change the <code>output column prefix</code> to something more informative. Then hit <code>Run</code>.</li>
</ol>
<p>Examine the output of the tool. What did it do? Before we move on, rename the output layer (called <code>Sampled</code> by default) to something more useful.</p>
<p>Now run the same steps as above, but use the output layer as your input and the 30 meter DEM as your raster. You should now have a new point layer that includes the elevation attributes from both DEMs. Open the attribute table and look at the values - why do you think the values are different? Are there certain areas where they’re closer than other areas? Why might that be?</p>
<p><strong>Take a screenshot of your final attribute table and add it to your submission doc.</strong></p>
<p>Now let’s talk about visualizing elevation. By default, the numerical values of each pixel in a DEM are symbolized on a scale of black and white, also known as <code>Singleband gray</code>. In this state it’s pretty difficult to gain any information from the image, so let’s change it to something more useful.</p>
</section>
<section id="hillshade" class="level3">
<h3 class="anchored" data-anchor-id="hillshade">Hillshade</h3>
<ol type="1">
<li>Open up the Symbology window for the 1m DEM layer (can elaborate here if needed).</li>
<li>Where it says <code>Render Type</code>, click the dropdown and select <code>Hillshade</code>.</li>
</ol>
<div id="tip-hillshade" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;3: Azimuth and Z Factor
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can adjust the output of our hillshade by changing the values of the <code>azimuth</code> and <code>Z factor</code>. Take a moment to play around with the values for these parameters. What do you think each one does?</p>
</div>
</div>
<p>After you hit <code>Apply</code>, your DEM should look something like this:</p>
<div id="fig-hillshade" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Image showing a hillshade render of a DEM" data-fig-cap="Hillshade">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hillshade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/hillshade_example.png" class="img-fluid figure-img" data-fig-cap="Hillshade" alt="Image showing a hillshade render of a DEM">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hillshade-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Hillshade
</figcaption>
</figure>
</div>
<p>Try the same process with your 30 meter DEM. How do the outputs differ?</p>
<p><strong>Take a screenshot of your hillshade render and add it to your submission doc.</strong></p>
</section>
<section id="contour-lines" class="level3">
<h3 class="anchored" data-anchor-id="contour-lines">Contour Lines</h3>
<ol type="1">
<li>Go back to the Symbology window and change the Render Type to <code>Contour</code>. Adjust the <code>Contour Interval</code> and <code>Index Contour Interval</code> until the amount of bands generated feels good to you (i.e.&nbsp;not <em>too</em> cluttered, but enough to actually show the topography). I would also recommend making the Index lines slightly thicker, for visual differentiation.</li>
</ol>
<p>Now your DEM should look something like this:</p>
<div id="fig-contour" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Image showing the contour lines of a DEM" data-fig-cap="Contour Lines">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-contour-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/contour_example.png" class="img-fluid figure-img" data-fig-cap="Contour Lines" alt="Image showing the contour lines of a DEM">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-contour-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Contour Lines
</figcaption>
</figure>
</div>
<p>We have another opportunity to compare our DEMs here. Change the symbology of your 30 meter DEM to contour lines, and look at the two layers together. Again, how do the two layers differ? What might be the cause of that?</p>
<p><strong>Take a screenshot of your contour render and add it to your submission doc.</strong></p>
</section>
</section>
<section id="task-2-saving-and-exporting-dem-visualizations" class="level2">
<h2 class="anchored" data-anchor-id="task-2-saving-and-exporting-dem-visualizations">Task 2: Saving and Exporting DEM Visualizations</h2>
<p>While these changes to symbology can be useful for quick visualizations of the landscape, if we were to send our DEM file to someone else, the adjustments wouldn’t be reflected on their end. Luckily, QGIS also has processing tools that we can use to turn our hillshade and contour lines into separate layers that <em>can</em> be shared.</p>
<section id="hillshade-1" class="level3">
<h3 class="anchored" data-anchor-id="hillshade-1">Hillshade</h3>
<ol type="1">
<li>From the Raster menu, go to Analysis &gt; Hillshade (or search Hillshade in the processing tools window).</li>
<li>Adjust the Z factor if you’d like. Let’s keep the azimuth at its default for now.</li>
<li>Click on the 3 dots to the right of the <code>[Save to temporary file]</code> box and select <code>Save to file</code>. Navigate to your <code>data</code> folder and name the file something you can identify it by (i.e.&nbsp;include hillshade in the name). Before you hit <code>Save</code>, make sure the file format is <code>.tif</code>.</li>
<li>Leave all other parameters at their default and hit <code>Run</code>.</li>
</ol>
</section>
<section id="contour-lines-1" class="level3">
<h3 class="anchored" data-anchor-id="contour-lines-1">Contour Lines</h3>
<ol type="1">
<li>Now go to Raster &gt; Extraction &gt; Contour (or search Contour in the processing tools window).</li>
<li>Adjust the contour interval to the same value you used before (for this tool we don’t specify an index interval).</li>
<li>Save the layer as a new file the same way you did above. Make sure that the file type is <code>.geojson</code>.</li>
<li>Leave all other parameters at their default and hit <code>Run</code>.</li>
</ol>
</section>
<section id="combining-dem-visualizations" class="level3">
<h3 class="anchored" data-anchor-id="combining-dem-visualizations">Combining DEM Visualizations</h3>
<p>You should have two new layers on your map. We can now combine all of our DEM layers together to create an aesthetically pleasing map.</p>
<ol type="1">
<li>Open up the Symbology window for our original DEM and change the Render Type to <code>Singleband pseudocolor</code>. Choose any of the color ramps from the dropdown.</li>
<li>Make sure your hillshade layer is the second layer in the stack. In the Symbology window, change the <code>blending mode</code> to <code>multiply</code>. Locate the Transparency tab (one below Symbology), and adjust the layer opacity to your liking.</li>
<li>Make sure your contour layer is the topmost layer. Go to the Symbology window and adjust the color and thickness of your lines to your liking.</li>
</ol>
<div id="fig-dem_all" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Image showing a DEM with hillshade and contour lines layered on top" data-fig-cap="Base DEM with Hillshade and Contour Lines">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dem_all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/dem_all.png" class="img-fluid figure-img" data-fig-cap="Base DEM with Hillshade and Contour Lines" alt="Image showing a DEM with hillshade and contour lines layered on top">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dem_all-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Layered DEM
</figcaption>
</figure>
</div>
<p><strong>Another Option: Red Relief</strong></p>
<p>Alternatively, we can combine our DEM and hillshade layers to create the red relief visualization that we talked about in lecture.</p>
<ol type="1">
<li>Change the render type of the original DEM back to <code>singleband gray</code>.</li>
<li>Change the render type of the hillshade layer to <code>singleband pseudocolor</code>.</li>
<li>Under the color ramp dropdown, choose <code>Create new color ramp</code>. Set the first color to black, and choose a shade of red for the second.</li>
<li>Go back to the transparency tab and adjust the opacity to your liking.</li>
</ol>
<div id="fig-dem_red" class="quarto-float quarto-figure quarto-figure-center anchored" alt="Image showing a DEM with hillshade render changed to a red gradient" data-fig-cap="Base DEM with Red Relief Hillshade. Contour lines removed.">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dem_red-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/dem_red.png" class="img-fluid figure-img" data-fig-cap="Base DEM with Red Relief Hillshade. Contour lines removed." alt="Image showing a DEM with hillshade render changed to a red gradient">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dem_red-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Red Relief Hillshade
</figcaption>
</figure>
</div>
<p>Nice! Something like this can be a great base for displaying other data layers (foreshadowing).</p>
</section>
</section>
<section id="task-3-extracting-information-from-dems" class="level2">
<h2 class="anchored" data-anchor-id="task-3-extracting-information-from-dems">Task 3: Extracting Information from DEMs</h2>
<p>There are many uses for DEMs beyond elevation, and many tools that we can use to extract additional information from them!</p>
<p>For the rest of this exercise, you’ll need to download <a href="https://github.com/kulpojke/nr218/blob/main/assets/spr_lab_8.zip" title="Follow the link and click download raw file button on upper left">this zip file</a>(Open the link in a new tab and click “download raw file” button on upper right). Unzip the file and move the newly generated folder to <code>data</code>.</p>
<p>Add all of the files in the unzipped folder to your project in QGIS. You can remove the DEM layers used above .</p>
<div id="tip-spr_prep" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;4: Layer Preparation
</div>
</div>
<div class="callout-body-container callout-body">
<p>Take a quick look through the layers from the folder. What types of data are we dealing with? Are they all in the same CRS? If not, we should take a moment to reproject.</p>
</div>
</div>
<section id="slope-and-aspect" class="level3">
<h3 class="anchored" data-anchor-id="slope-and-aspect">Slope and Aspect</h3>
<p><code>Slope</code> tells us how steep the terrain is (in degrees or percent change from horizontal). <code>Aspect</code> tells us which compass direction each slope of the terrain faces.</p>
<p>We can generate layers for slope and aspect similarly to how we created our hillshade and contour layers. For slope, go to Raster &gt; Analysis &gt; Slope. Make sure your input layer is <code>spr_DEM</code>, and keep all other parameters at their default. Save the output to a file, like we did above, and hit <code>Run</code>. Do the same for aspect (Raster &gt; Analysis &gt; Aspect).</p>
<p>Examine the outputs of each analysis tool. What might you use a map of slope for? What about aspect?</p>
<p><strong>Write down your thoughts and add screenshots of your slope and aspect layers to your submission doc.</strong></p>
<div id="tip-terrain_analysis" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;5: Terrain Analysis
</div>
</div>
<div class="callout-body-container callout-body">
<p>Together with hillshade and contours, slope and aspect are often categorized as <code>terrain analysis</code>. We can generate other layers of information in a similar way, such as <code>topographic position index (TPI)</code>, which classifies each pixel in relation to the altitude of its neighboring cells. Other terrain indices you might encounter include the <code>topographic wetness index (TWI)</code> and <code>topographic ruggedness index (TRI)</code>.</p>
</div>
</div>
</section>
</section>
<section id="task-4-putting-it-all-together" class="level2">
<h2 class="anchored" data-anchor-id="task-4-putting-it-all-together">Task 4: Putting It All Together</h2>
<p>Oh no! Hydrologists at Swanton Pacific Ranch have lost track of all of their rain gauges! Luckily, we have the point layer open in QGIS right now. Since we have it open, they’ve asked for our help identifying one specific rain gauge. The rain gauge they’re looking for is:</p>
<ul>
<li>On a slope that’s facing Northwest</li>
<li>Above 200 meters of elevation</li>
<li>On a relatively flat area (less than 5 degrees of steepness)</li>
</ul>
<blockquote class="blockquote">
<p>Note! the pixel values for the Swanton Pacific Ranch DEM are in meters.</p>
</blockquote>
<p>Using the layers that you’ve created, and the tools we’ve practiced with in this lab (OR tools that we’ve used in past labs… hint hint…), identify which rain gauge the team is looking for.</p>
<p><strong>Once you have your answer, note which rain gauge the hydrologists are looking for, what the associated values are for slope, aspect, and elevation, and explain how you reached your conclusion on your submission doc.</strong></p>
<section id="bonus-exporting-a-map" class="level3">
<h3 class="anchored" data-anchor-id="bonus-exporting-a-map">Bonus: Exporting a Map</h3>
<p>Great! Now that we’ve found the rain gauge, the hydrologists need a way to navigate to it. Let’s make them a couple maps to use as a reference. First, we’ll make a <code>GeoPDF</code>, or a georeferenced PDF.</p>
<p><strong>Exporting a GeoPDF</strong></p>
<p>Re-run the steps above to generate hillshade and contour layers for the SPR DEM. You can either do this using the Symbology tab, or generate two new layers. Once you have a map image that you’re satisfied with, go to <code>Project &gt; Import/Export &gt; Export Map to PDF</code>.</p>
<p>In the popup window, you can leave everything at its default, but make sure to check the box next to <code>Create Geospatial PDF</code>. Hit Save, and then navigate to your <code>lab_8/docs</code> folder and choose an appropriate name for the file.</p>
<p>Let’s take a look at what we just exported! Locate the file on your computer and open it in Adobe or a similar PDF viewer. Look for a <code>Layers</code> icon, and see what you can do - you should be able to toggle the map layers on and off. Pretty cool!</p>
<div id="tip-avenza" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;6: Using a GeoPDF in the Field
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you have the app <code>Avenza</code> on your phone, or something similar, you can import GeoPDFs from QGIS and use them as your base map! In this case, someone could in theory travel to Swanton and use the PDF we just exported to locate the missing rain gauge.</p>
</div>
</div>
<p><strong>Exporting a Print Layout</strong></p>
<p>It’s good practice for us to also export the map as a flattened PDF.</p>
<ol type="1">
<li>Create a new map layout by clicking the <code>New Print Layout</code> icon or hitting <code>Ctrl/Cmd + P</code>. Name it something useful.</li>
</ol>
<div id="tip-grids" class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip&nbsp;7: Using Guidelines for Easier Map Making
</div>
</div>
<div class="callout-body-container callout-body">
<p>When setting up a map layout, we can make our lives easier by putting down guide lines for map items to automatically snap to. Let’s try it now - select the <code>Guides</code> tab on the right panel and add some horizontal and vertical lines. You can click on the side rulers, or manually type in the values that you’d like your lines to appear at.</p>
</div>
</div>
<ol start="2" type="1">
<li>Now add a new map to the layout (Add Item &gt; Add Map or click the Add Map Icon on the left side panel). Adjust the map to your liking by selecting <code>Move Item Contents</code> or hitting the <code>C</code> key. You can also manually set the scale of the map in the Item Properties window. Do that now, and change it to a round number large enough to view the entire extent of the layers.</li>
<li>Next we’ll add a legend. Once you’ve created one, go to the Item Properties tab on the right and do some clean-up. Remember we can adjust which layers are included in our legend by un-checking <code>Auto-update</code>, and then removing unwanted entries. We can also rename the entries we <em>are</em> keeping by double clicking on their names.</li>
<li>Next let’s add a scale bar. Play around with the number and width of each segments - you want to end up with a value that will be informative to your viewers. Place a second scale bar next to the first, and change the <code>Style</code> to <code>Numeric</code>. What does this number mean? Think back to step 1 - why is it helpful to set the scale to be a round number?</li>
<li>Lastly, add a map title.</li>
<li>Click the <code>Export as PDF</code> icon, or go to Layout &gt; Export as PDF.</li>
<li>Save your pdf in your <code>lab_8/docs</code> folder, and name it something useful.</li>
<li>In this case, you can leave all of the parameters as-is and just hit save.</li>
</ol>
<p><strong>Use <code>tree</code> to show the directory structure for the project so far. Include it in your submission doc.</strong></p>
<p><strong>Upload your final map in addition to your submission doc.</strong></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>