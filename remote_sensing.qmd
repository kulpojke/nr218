# Remote Sensing!



## Remote sensing

::: {.columns}

::: {.column width="35%"}
::: {.r-stack style="position: relative; min-height: 400px;"}

::: {.fragment .absolute .fade-in-then-out data-fragment-index="1" style="max-width: 100%; font-size:0.6em;"}
__Remote sensing__ - Obtaining information about an object from a distance.
:::


::: {.fragment .absolute .fade-in-then-out data-fragment-index="2" style="max-width: 100%; font-size:0.6em;"}
What is the most basic form of remote sensing you can think of?
:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="3" style="max-width: 100%; font-size:0.8em;"}

[Looking at something!]{style="color: red;"}
:::


::: {.fragment .absolute .fade-in-then-out data-fragment-index="4" style="max-width: 100%; font-size:0.6em;"}
There are many different methods of remote sensing.

+ Some ground based
+ Some airborne
+ Some satellite based
:::


::: {.fragment .absolute .fade-in-then-out data-fragment-index="5" style="max-width: 100%; font-size:0.6em;"}
+ Most remote sensing relies on electromagnetic radiation
:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="6" style="max-width: 100%; font-size:0.6em;"}
Red band (0.63 - 0.69 µm)

![](img/rspec.png)

Useful for:  

+ Detecting bare soil, buildings, pavement
+ Chlorophyll absorption

:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="7" style="max-width: 100%; font-size:0.6em;"}
Green band (0.52 - 0.6 µm)

![](img/gspec.png)

Useful for:  

+ phenology / vegetation dynamics
+ plant Health
+ algal Blooms
:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="8" style="max-width: 100%; font-size:0.6em;"}
Blue band (0.45 - 0.52 µm)

![](img/bspec.png)

Useful for:  

+ water
+ clouds 
+ snow
+ aerosols

:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="9" style="max-width: 100%; font-size:0.6em;"}
NIR band (0.77 - 0.9 µm)


![](img/nirspec.png)

Useful for:  

+ biomass
+ vegetation detection
+ boundary detection
:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="10" style="max-width: 100%; font-size:0.6em;"}
A "True Color" image used Red, Green and Blue 

![](img/rgbspec.png)

::: {style="font-size:0.5em"}
+ Pixels in display contain 3 sub-pixels
+ Each sub-pixels intensity is controlled by the intensity value in the image
+ Intensity values are stored as 8-bit unsigned integers (`uint8`) 
    + 8 bits = $2^{8}$ = 256 possible values
    + Range: 0 to 255 (256 values total)
    + Images are sometimes _stored_ with higher precision, but displayed with 8 bits
:::

```
(255, 0, 0)   = pure red
(0, 255, 0)   = pure green
(0, 0, 255)   = pure blue
(255, 255, 0) = yellow (red + green)
(0, 255, 255) = cyan (green + blue)
(255, 0, 255) = magenta (red + blue)
(255, 255, 255) = white (all combined)
(0, 0, 0)     = black (none)
```

:::


::: {.fragment .absolute .fade-in-then-out data-fragment-index="11" style="max-width: 100%; font-size:0.6em;"}
Combining bands on different ways is often useful.

![](img/false_spec.png)

For example, False Color Image

+ Near-Infrared to Red, Red to Green, and Green to Blue (NIR, G, R)           
:::


::: {.fragment .absolute .fade-in-then-out data-fragment-index="12" style="max-width: 100%; font-size:0.6em;"}

+ Humans see only a small portion of the EM spectrum. 
+ Instruments on satellites capture more, but still only a small portion of the entire electromagnetic spectrum

[__Right__:  Reflectance of water, soil and vegetation in different wavelengths and Landsat TM channels.]{style="font-size:0.5em"}
:::

::: 
<!-- end r-stack -->
::: 
<!-- end column -->

::: {.column width="65%"}

::: { .r-stack}

::: {.fragment .absolute .fade-in-then-out data-fragment-index="3"}
![](img/Mother_Bird_by_Keisuke_Aso_Aisawa.jpeg){width="100%" style="max-width: 100%; height: auto; object-fit: contain;"}

::: {.attribution style="font-size:0.4em"}
Image Source: [Wikimedia](https://commons.wikimedia.org/wiki/File:Electromagneticwave3D.gif)
:::  
:::  

::: {.fragment .absolute .fade-in-then-out data-fragment-index="5"}
![](img/Electromagneticwave3D.gif){width="100%" style="max-width: 100%; height: auto; object-fit: contain;"}


::: {.attribution style="font-size:0.4em"}
Image Source: [Wikimedia](https://commons.wikimedia.org/wiki/File:Electromagneticwave3D.gif)
:::  
:::  

::: {.fragment .absolute .fade-in-then-out data-fragment-index="6"}
![](img/red.png)
:::


::: {.fragment .absolute .fade-in-then-out data-fragment-index="7"}
![](img/green.png)
:::


::: {.fragment .absolute .fade-in-then-out data-fragment-index="8"}
![](img/blue.png)
:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="9"}
![](img/nir.png)
:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="10"}
![](img/rgb.png)
:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="11"}
![](img/false.png)
:::


::: {.fragment .absolute .fade-in-then-out data-fragment-index="12"}
![](img/EM_nasa.png){width="100%" style="max-width: 100%; height: auto; object-fit: contain;"}

::: {.attribution style="font-size:0.4em"}
Image Source: [NASA](https://appliedsciences.nasa.gov/sites/default/files/2022-11/Fundamentals_of_RS_Edited_SC.pdf)
:::
:::


:::
<!-- end r-stack -->
::: 
<!-- end column -->

:::
<!-- end columns -->

## Passive vs. Active

::: { .r-stack}

::: {.fragment .absolute .fade-in-then-out data-fragment-index="1"}
![](img/active-passive-remote-sensing.png)

::: {.attribution style="font-size:0.4em"}
Image Source: [NASA Earthdata](https://www.earthdata.nasa.gov/learn/earth-observation-data-basics/remote-sensing)
:::

:::

::: {.fragment .absolute .fade-in data-fragment-index="2"}
+ The type of remote sensing we have been discussing so far is  _optical_ remote sensing. 
    + Optical remote sensing is a is passive 
    + Light from the sun bounces off of the earth and into the sensor (Eyeball, Camera, Radiometer)
+ _Radiometric_ sensing covers a wider spectral range, and may include active as well as passive techniques.

:::

:::

## NAIP Imagery

::: {.columns}
::: {.column style="font-size:0.5em"}
**National Agriculture Imagery Program (NAIP)**

+ High-resolution aerial imagery of the continental United States
+ Collected during agricultural growing seasons
+ Typically 4-band: Red, Green, Blue, Near-Infrared (NIR)
+ 60 cm (or better) spatial resolution
+ Updated on a 2-3 year cycle for each state

**Learn more:** [USDA NAIP Program](https://www.fsa.usda.gov/programs-and-services/aerial-photography/imagery-programs/naip-imagery/)
:::
::: {.column}
![A NAIP image](img/rgb.png)
:::
:::

## Filter, Map, Reduce

+ Filter - Find the subset of data needed.
+ Map - Transform the raw data into useful data
+ Reduce - Extract needed information

## Spectral indices {.smaller}

Spectral index 

+ A mathematical equation that is applied on the various spectral bands of an
image on a per pixel basis
+ Maps multiple bands to a single band
+ Simple band ratios that highlight a specific process or property on the land
surface
+ Reduce effects of atmosphere, instrument noise, sun angle: allows for consistent
spatial and temporal comparisons [^nasa]

[^nasa]:  NASA ARSET slideshow _Spectral Indices for Land and Aquatic Applications_


## Spectral Response Curves {.smaller}

::: { .r-stack}

::: {.fragment .absolute .fade-out data-fragment-index="1"}
![](img/exploit_spectral_response.png)

::: {.attribution style="font-size:0.4em"}
Image Source: [SEOS](https://seos-project.eu/classification/classification-c01-p05.html)
:::

:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="1" style="font-size:0.8em"}
$$
\text{NBR} = \frac{\text{NIR} - \text{SWIR-2}}{\text{NIR} + \text{SWIR-2}} = \frac{B_8 - B_{12}}{B_8 + B_{12}}
$$

![](img/mendo_fires.png){width="80%" style="max-height: 70vh; object-fit: contain;"}
:::

:::


## Common Spectral Indices {style="font-size:0.5em"}
| Index | Formula | Typical Use |
| --- | --- | --- |
| NDVI | $(\text{NIR} - \text{Red}) / (\text{NIR} + \text{Red})$ | Vegetation greenness/vigor |
| EVI | $2.5 \cdot (\text{NIR} - \text{Red}) / (\text{NIR} + 6\cdot\text{Red} - 7.5\cdot\text{Blue} + 1)$ | Dense vegetation, reduces soil/atmosphere effects |
| SAVI | $(1 + L)\cdot(\text{NIR} - \text{Red}) / (\text{NIR} + \text{Red} + L)$ | Vegetation with soil brightness correction ($L$ often 0.5) |
| NDWI | $(\text{Green} - \text{NIR}) / (\text{Green} + \text{NIR})$ | Surface water detection |
| MNDWI | $(\text{Green} - \text{SWIR-1}) / (\text{Green} + \text{SWIR-1})$ | Open water enhancement, reduced built-up/soil noise |
| NBR | $(\text{NIR} - \text{SWIR-2}) / (\text{NIR} + \text{SWIR-2})$ | Burn severity, fire impacts |
| NDMI | $(\text{NIR} - \text{SWIR-1}) / (\text{NIR} + \text{SWIR-1})$ | Vegetation moisture |


## NDVI

$(\text{NIR} - \text{Red}) / (\text{NIR} + \text{Red})$

::: {.fragment .absolute .fade-out data-fragment-index="1"  }
![](img/spectral_signatures_landsat_450.jpg)
:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="1"}
![](img/trees_ndvis.png)

::: {.attribution style="font-size:0.4em"}
Image Source: [NASA ARSET](https://appliedsciences.nasa.gov/sites/default/files/2023-10/Spectral_Indices_Part1.pdf)
:::
:::


::: {.fragment .absolute .fade-in-then-out data-fragment-index="2"}
![](img/seasons_ndvi.png)
:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="3"}
![](img/drought_ndvi.png)

::: {.attribution style="font-size:0.4em"}
Image Source: [NASA ARSET](https://appliedsciences.nasa.gov/sites/default/files/2023-10/Spectral_Indices_Part1.pdf)
:::
:::






## Raster Resampling {style="font-size:0.6em"}

::: {style="font-size:0.7em"}
Resampling is adjusting the pixel size or resolution of raster data in order to:

+ __Match resolutions__ - So multiple rasters will align[^match] for analyisis (e.g., NDVI and elevation) 
+ __Downsample__ - Reduce resolution for faster processing

::: {style="margin-left: 2em;"}
![](img/down_sample.png)
:::

+ __Upsample__ - Increase resolution for finer analyses (though it won’t create new information)

::: {style="margin-left: 2em;"}
![](img/up_sample.png)
:::

::: {style="font-size:0.5em"}
[^match]: Resampling  does not , by definition, align pixels between rasters, but alignment is included in many resampling algorithms.
:::

:::


## Raster Resampling - Methods {style="font-size:0.6em"}

::: { .r-stack}

::: {.fragment .absolute .fade-out data-fragment-index="1"}
__Nearest Neighbor Resampling__

- The new raster pixels get the value from nearest pixel of the original raster to the center of the new pixel.
- Note that some of the values are lost this way (particularly in downsampling), since they were not passed on to the new raster

![](img/resamp_nn.png){width="80%" style="max-height: 70vh; object-fit: contain;"}
:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="1"}
__bilinear resampling__

- Each new raster cell gets a weighted average of four nearest cells from the input, rather than just one
- Less loss of information

![](img/resamp_bilin.png){width="80%" style="max-height: 70vh; object-fit: contain;"}

:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="2"}
__Average resampling__

- Each new cell gets the (non-weighted) average of all overlapping input cells

![](img/resamp_avg.png){width="80%" style="max-height: 70vh; object-fit: contain;"}
:::

:::


## Raster Resampling {style="font-size:0.6em"}

::: { .r-stack}
::: {.fragment .absolute .fade-out data-fragment-index="1"}
There are two$^*$ tools for resampling in QGIS

::: {.columns}
::: {.column width="%"}
![](img/resamp_menu2.png)
:::

::: {.column width="%"}
![](img/resamp_menu.png)
:::

:::
[* Actually there are others, notably if Grass is installed its tools are also available.]{style="font-size:0.5em"}
:::




::: {.fragment .absolute .fade-in-then-out data-fragment-index="1"}
| Feature | QGIS Align Rasters | GDAL Warp |
|---------|-------------------|-----------------|
| Align to grid | ✅ Yes (to reference) | ✅ Yes (to round coords) |
| Resample | ✅ Yes | ✅ Yes |
| Match resolution | ✅ Yes | ⚠️ Only if specified |
| Match extent | ✅ Yes | ⚠️ Only if specified |
| Grid type | Reference raster | Integer/round coordinates |
:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="2"}
+ QGIS Align Rasters
+ GDAL Warp is more flexible
    + It can reproject
    + It can clip to an extent
+ It is a useful command line tool
:::

:::

## Raster Resampling


## Raster Reprojection (Warping)

::: {.columns}
::: {.column width="40%"}
::: { .r-stack}

::: {.fragment .fade-in-then-out data-fragment-index="1" style="font-size:0.7em"}
Just like vector data, we need to reproject rasters if we’re to do accurate analysis. 
:::

::: {.fragment .fade-in-then-out data-fragment-index="2" style="font-size:0.7em"}
The goal is to realign the pixels, without changing their values.
:::

::: {.fragment .fade-in-then-out data-fragment-index="3" style="font-size:0.7em"}
The goal is to realign the pixels, without changing their values.
:::

::: {.fragment .fade-in-then-out data-fragment-index="4" style="font-size:0.7em"}
What happens in the reprojection can be thought of as a two-step process

1. The pixel outlines are reprojected as if they were polygons
2. This results in an irregular grid
3. The grid is then resampled to form a regular grid

:::


:::

:::


::: {.column width="60%"}
::: { .r-stack}
::: {.fragment .absolute .fade-in-then-out data-fragment-index="1"}
![](img/grid_warp.png){width="80%" style="max-height: 70vh; object-fit: contain;"}
:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="2"}
![](img/rast_sin_to_ITM.png){width="80%" style="max-height: 70vh; object-fit: contain;"}
:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="3"}
![](img/sin_to_ITM.png){width="80%" style="max-height: 70vh; object-fit: contain;"}
:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="4"}
![](img/pix_reproj.png){width="80%" style="max-height: 70vh; object-fit: contain;"}
:::


:::

:::
:::

## Raster Reprojection using GDAL Warp

::: { .r-stack}

::: {.fragment .absolute .fade-out data-fragment-index="1" style="font-size:0.7em"}

0. Download [dw_2025.tif](https://cpslo-my.sharepoint.com/:i:/g/personal/mthuggin_calpoly_edu/EdgBHLPzgANIkCbXNrV4ezoBFWEp9jQzWmIp1js7SUsPhg?e=1r3ifc) and [dw_20218.tif](https://cpslo-my.sharepoint.com/:i:/g/personal/mthuggin_calpoly_edu/EVeMfAwzkw5PqQ8KlJxY73wBSm8B23Zymz5RAFje821Jfw?e=vIZ0rz) as well as [dw_style.qml]()https://cpslo-my.sharepoint.com/:u:/g/personal/mthuggin_calpoly_edu/EXMEE6bR85VMkOPotG9dk6sBbr2JQx2QNFtsR9-0OAIQfg?e=aa09WA

1. In QGIS open dw_2025. 
    a. Look at the CRS
    b. Look at the resolution.

2. In the symbology tab, at the bottom left there is a style dropdown.
    a. select "Load Style..." use the browser to open the `dw_style.qml` file from the `dynamic_world` folder
    b. Apply

:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="1" style="font-size:0.7em"}
Reproject dw_2025 using GDAL Warp (`Processing Toolbox: GDAL → Raster projection → Warp`)

+ Leave Source CRS blank (In "Input layer" you can see that the CRS is recognized)
+ Set Target CRS to EPSG:6339
+ Use average resampling
+ Set " Output file resolution in target georeferenced units" to 10
    + What are the target georeferenced units?
+ Leave the rest as defaults, including  "[save to temporary Layer]"

__Compare the results to the original. Do you see any problems?__

:::

::: {.fragment  .fade-in-then-out data-fragment-index="2" style="font-size:0.7em"}
Why is this margin of different land cover appearing?

::: {.columns}
::: {.column width="%"}
![](img/original.png){width="80%" style="max-height: 70vh; object-fit: contain;"}
:::

::: {.column width="%"}
![](img/reproj_avg_bad.png){width="80%" style="max-height: 70vh; object-fit: contain;"}
:::
:::

:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="3" style="font-size:0.7em"}
Try again, what resampling method should you use?
:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="4" style="font-size:0.7em"}
::: {.columns}
::: {.column width="%"}
![](img/original.png){width="80%" style="max-height: 70vh; object-fit: contain;"}
:::

::: {.column width="%"}
![](img/reproj_nn.png){width="80%" style="max-height: 70vh; object-fit: contain;"}
:::
:::

:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="5" style="font-size:0.7em"}
+ Save the reprojected layer `dw_2025_6339.tif`.
+ Reproject dw_2018 in the same way (save as `dw_2018_6339.tif`)
:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="6" style="font-size:0.7em"}
+ Use `Raster Tools → Align Rasters` to align `dw_2018_6339.tif` and `dem_1m_6339.tif` to dw_2025_6339 (use appropriate resample methods).

{{< video img/align.webm width="80%" style="max-height: 70vh; object-fit: contain;" >}}
:::

::: {.fragment .absolute .fade-in-then-out data-fragment-index="7" style="font-size:0.7em"}
+ Now use the the Raster Calculator to Find areas that were covered in trees in 2018, but not in 2025.


:::

:::
