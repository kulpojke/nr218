try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="dc3dc35f-bbb8-498c-b4e3-84b04c54d387",e._sentryDebugIdIdentifier="sentry-dbid-dc3dc35f-bbb8-498c-b4e3-84b04c54d387")}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4595],{18472:(e,t,o)=>{o.d(t,{O:()=>n});var s=o(54568),l=o(32987);let n=e=>{let{size:t=20,borderRadius:o=.27*t,className:n,children:r}=e;return(0,s.jsx)("div",{style:{width:t,height:t,borderRadius:o},className:(0,l.A)("shrink-0 bg-bg-000 border-border-300 border-0.5 shadow-sm flex items-center justify-center",n),children:r})}},20878:(e,t,o)=>{o.d(t,{W:()=>r});var s=o(68096),l=o(1761),n=o(7620);function r(){let{mutate:e,isPending:t}=(0,s.Jy)(),{account:o}=(0,l.YL)();return{dismiss:(0,n.useCallback)(t=>{var s,l,n;o&&(null!=o&&null!=(l=o.settings)&&null!=(s=l.dismissed_claudeai_banners)&&s.some(e=>e.banner_id===t)||e({...o.settings,dismissed_claudeai_banners:[...(null==o||null==(n=o.settings)?void 0:n.dismissed_claudeai_banners)||[],{banner_id:t,dismissed_at:new Date().toISOString()}]}))},[o,e]),isDismissed:(0,n.useCallback)(e=>{var t,s;return(null==o||null==(s=o.settings)||null==(t=s.dismissed_claudeai_banners)?void 0:t.some(t=>t.banner_id===e))||!1},[o]),isPending:t}}},22364:(e,t,o)=>{o.d(t,{P:()=>v});var s=o(54568),l=o(1761),n=o(15046),r=o(41417),a=o(56370),i=o(12072),c=o(60265),u=o(99272),d=o(32987),m=o(62971),p=o(92947);function v(e){var t,o;let{tool:v,server:g,children:f}=e,{account:h}=(0,l.YL)(),b=null!=(o=null==h||null==(t=h.settings)?void 0:t.enabled_mcp_tools)?o:{},{toggleMcpToolEnabled:y,toggleMcpToolAlwaysApproved:S}=(0,p.es)(),{getApprovalSetting:C}=(0,p.BN)(),_=C(g.name,v),w="never"===_,x="always"===_,R=v.enabledKey,j=(e,t,o)=>(0,s.jsxs)("div",{className:"flex flex-row gap-2 items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[t,(0,s.jsx)("p",{className:"text-sm text-text-400",children:o})]}),(0,s.jsx)(c.J,{size:16,className:(0,d.A)("shrink-0",e?"opacity-1":"opacity-0")})]}),T=(0,s.jsx)(r.$,{variant:"outline",disabled:!1===b[R]||x,append:(0,s.jsx)(u.a,{size:16}),className:"!min-w-[200px] flex justify-between items-center",children:"never"===_?(0,s.jsx)(m.A,{defaultMessage:"Allow unsupervised",id:"R3Brpp1rTt"}):(0,s.jsx)(m.A,{defaultMessage:"Always ask permission",id:"vJAsn99Znq"})});return(0,s.jsxs)("div",{className:"flex flex-row gap-4 flex-shrink-0",children:[(0,s.jsx)("label",{children:(0,s.jsx)(n.j,{checked:!1!==b[R],onChange:e=>y(R,e.target.checked,g.url)})}),(0,s.jsx)("div",{className:"flex flex-grow",children:f}),(0,s.jsxs)(a.ms,{unstyledTrigger:!0,align:"start",trigger:x?(0,s.jsx)(i.Tooltip,{side:"top",tooltipContent:(0,s.jsx)(m.A,{defaultMessage:"Setting manged by your organization",id:"+y38sDfyun"}),children:(0,s.jsx)("div",{children:T})}):T,children:[(0,s.jsx)(a.tJ,{onClick:()=>{S(v.alwaysApprovedKey,!1)},children:j(!w,(0,s.jsx)(m.A,{defaultMessage:"Always ask permission",id:"vJAsn99Znq"}),(0,s.jsx)(m.A,{defaultMessage:"Your approval is required every time",id:"Ne5BQmk7c1"}))}),(0,s.jsx)(a.tJ,{onClick:()=>{S(v.alwaysApprovedKey,!0)},children:j(w,(0,s.jsx)(m.A,{defaultMessage:"Allow unsupervised",id:"R3Brpp1rTt"}),(0,s.jsx)(m.A,{defaultMessage:"Your approval is not required",id:"9AbpSd6OJA"}))})]})]})}},62370:(e,t,o)=>{o.d(t,{rD:()=>x,nd:()=>_,s$:()=>w,Ug:()=>j,pK:()=>F,KU:()=>q,_b:()=>V,dY:()=>N,et:()=>S,xk:()=>C,H:()=>z,eg:()=>T,jh:()=>I,kU:()=>O,BG:()=>Y,zC:()=>E,fR:()=>K,kc:()=>A,pZ:()=>k,k$:()=>P,aF:()=>M,n3:()=>R,MR:()=>L,qT:()=>$,Ak:()=>H,Uz:()=>U,Q1:()=>B});var s=o(87856),l=o(7620),n=o(13368),r=o(35313),a=o(98736),i=o(97349),c=o(32442),u=o(44180),d=o(97136),m=o.n(d),p=o(75006);let v=e=>e.replace(/_/g," ").replace(/^\w/,e=>e.toUpperCase());async function g(e,t,o){try{return(await t.listTools({},{timeout:5e3})).tools.map(e=>o?(0,c.M)(e):e).map(t=>{var o,s,l;return{...t,displayName:v(t.title||(null==(o=t.annotations)?void 0:o.title)||t.name),enabledKey:(s=e,l=t.name,"".concat(s,":").concat(l)),alwaysApprovedKey:""}}).map(e=>({...e,alwaysApprovedKey:function(e){let t=e.enabledKey,o=e.description||"",s=function(e){var t;let o=Object.entries((null==(t=e.inputSchema)?void 0:t.properties)||{}),s=[];for(let[e,t]of o){let{data:o}=b.safeParse(t),l=(null==o?void 0:o.description)||"";s.push([e,l])}return s.sort((e,t)=>e[0].localeCompare(t[0])).flat().join(",")}(e),l=m().createHash("md5").update("".concat(o,":").concat(s)).digest("hex");return"".concat(t,"-").concat(l)}(e)}))}catch(t){return(0,u.Cp)(t,{tags:{action:"listTools",serverUuid:e}}),[]}}async function f(e,t){try{return(await t.listPrompts({},{timeout:5e3})).prompts.map(e=>({...e,displayName:v(e.title||e.name)}))}catch(t){return(0,u.Cp)(t,{tags:{action:"listPrompts",serverUuid:e}}),[]}}async function h(e,t){try{return(await t.listResources({},{timeout:5e3})).resources.map(e=>({...e,displayName:v(e.title||e.name)}))}catch(t){return(0,u.Cp)(t,{tags:{action:"listResources",serverUuid:e}}),[]}}let b=p.z.object({description:p.z.string().optional(),type:p.z.string().optional(),title:p.z.string().optional()}).optional(),y=(0,n.v)()((0,r.eh)(function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return{...(e=>({localClients:{},localTools:{},localPrompts:{},localResources:{},localIsLoading:!1,setLocalClient:(t,o)=>e(e=>({localClients:{...e.localClients,[t]:o}})),removeLocalServer:t=>e(e=>{let{[t]:o,...s}=e.localClients,{[t]:l,...n}=e.localTools,{[t]:r,...a}=e.localPrompts,{[t]:i,...c}=e.localResources;return{localClients:s,localTools:n,localPrompts:a,localResources:c}}),setLocalTools:(t,o)=>e(e=>({localTools:{...e.localTools,[t]:o}})),setLocalPrompts:(t,o)=>e(e=>({localPrompts:{...e.localPrompts,[t]:o}})),setLocalResources:(t,o)=>e(e=>({localResources:{...e.localResources,[t]:o}})),setLocalIsLoading:t=>e({localIsLoading:t})}))(...t),...(0,i.D)(...t)}})),S=e=>y.getState().remoteServers[e],C=async e=>y.getState().remoteClients[(0,i.I)(e)],_=e=>void 0===y.getState().remoteServers[e],w=e=>void 0===y.getState().remoteConnectionStates[e],x=e=>y.getState().addRemoteServer(e),R=(e,t)=>y.getState().setRemoteServerConnected(e,t),j=e=>y.getState().disconnectRemoteServer(e),T=e=>y.getState().removeRemoteServer(e),A=(e,t)=>y.getState().setRemoteClient(e,t),k=e=>y.getState().setRemoteIsLoading(e),L=async(e,t,o)=>{let s=await g(e,t,o);return y.getState().setRemoteTools(e,s),s},P=async(e,t)=>{let o=await f(e,t);return y.getState().setRemotePrompts(e,o),o},M=async(e,t)=>{let o=await h(e,t);return y.getState().setRemoteResources(e,o),o},N=e=>y.getState().localClients[e],I=(e,t)=>y.getState().setLocalClient(e,t),O=e=>y.getState().setLocalIsLoading(e),z=e=>y.getState().removeLocalServer(e),D=e=>"local:".concat(e),K=async(e,t,o)=>{let s=await g(D(e),t,o);return y.getState().setLocalTools(e,s),s},Y=async(e,t)=>{let o=await f(D(e),t);return y.getState().setLocalPrompts(e,o),o},E=async(e,t)=>{let o=await h(D(e),t);return y.getState().setLocalResources(e,o),o};function J(e,t){for(let[a,i]of Object.entries(t)){var o,s,l,n,r;if(void 0!==i){if("hasTools"===a){if(((null==(o=e.tools)?void 0:o.length)||0)>0!==i)return!1}else if("hasPrompts"===a){if(((null==(s=e.prompts)?void 0:s.length)||0)>0!==i)return!1}else if("hasResources"===a){if(((null==(l=e.resources)?void 0:l.length)||0)>0!==i)return!1}else if("hasPromptsOrResources"===a){let t=((null==(n=e.prompts)?void 0:n.length)||0)>0,o=((null==(r=e.resources)?void 0:r.length)||0)>0;if((t||o)!==i)return!1}else if(e[a]!==i)return!1}}return!0}let U=e=>{let t=y((0,a.k)(e=>({remoteServers:e.remoteServers,remoteConnectionStates:e.remoteConnectionStates,remoteTools:e.remoteTools,remotePrompts:e.remotePrompts,remoteResources:e.remoteResources,localClients:e.localClients,localTools:e.localTools,localPrompts:e.localPrompts,localResources:e.localResources})));return(0,l.useMemo)(()=>{var o,s,l,n,r,a;let i=[];for(let[n,r]of Object.entries(t.remoteServers)){if(!r)continue;let a={...r,uuid:n,type:"remote",...t.remoteConnectionStates[n],tools:null!=(o=t.remoteTools[n])?o:[],prompts:null!=(s=t.remotePrompts[n])?s:[],resources:null!=(l=t.remoteResources[n])?l:[],version:void 0};(!e||J(a,e))&&i.push(a)}i.sort((e,t)=>e.name.localeCompare(t.name));let c=[];for(let[o,s]of Object.entries(t.localClients)){if(!s)continue;let l={name:o,uuid:o,type:"local",isConnected:!0,isConnecting:!1,usedAuthentication:!1,tools:null!=(n=t.localTools[o])?n:[],prompts:null!=(r=t.localPrompts[o])?r:[],resources:null!=(a=t.localResources[o])?a:[]};(!e||J(l,e))&&c.push(l)}return c.sort((e,t)=>e.name.localeCompare(t.name)),[...i,...c]},[t,e])},B=()=>y(e=>e.remoteIsLoading||e.localIsLoading),H=()=>{let e=y(e=>e.remoteClients),t=y(e=>e.localClients);return(0,l.useMemo)(()=>[...Object.values(e).filter(e=>e instanceof s.K),...Object.values(t)],[e,t])},q=e=>{let t=N(e)||y.getState().remoteClients[e];if(!t)throw Error("Client not found for connector ".concat(e));if(t instanceof Promise)throw Error("Client for connector ".concat(e," is still connecting"));return t},F=e=>{let t=y.getState();for(let[s,l]of Object.entries(t.remoteServers)){var o;let n=null==(o=t.remoteTools[s])?void 0:o.find(t=>"".concat(l.name,":").concat(t.name)===e);if(n)return{tool:n,server:{uuid:s,name:l.name,url:l.url,type:"remote"}}}for(let[o,s]of Object.entries(t.localTools)){let t=s.find(t=>"".concat(o,":").concat(t.name)===e);if(t)return{tool:t,server:{uuid:o,name:o,type:"local"}}}},$=e=>Object.values(y.getState().remoteTools).flat().find(t=>t.name===e)||Object.values(y.getState().localTools).flat().find(t=>t.name===e),V=(e,t)=>{let o=y.getState(),s=[];if(!e)for(let[e,l]of Object.entries(o.remoteTools)){let n=o.remoteServers[e];n&&l.filter(e=>(null==t?void 0:t[e.enabledKey])!==!1).forEach(e=>{var t;s.push({name:e.name,description:null!=(t=e.description)?t:e.name,input_schema:e.inputSchema,integration_name:n.name,mcp_server_uuid:n.uuid})})}for(let[e,l]of Object.entries(o.localTools))l.filter(e=>(null==t?void 0:t[e.enabledKey])!==!1).forEach(t=>{var o;s.push({name:t.name,description:null!=(o=t.description)?o:t.name,input_schema:t.inputSchema,integration_name:e})});return s}},73347:(e,t,o)=>{o.d(t,{M:()=>c});var s=o(54568),l=o(41417),n=o(68711),r=o(32987),a=o(7620),i=o(62971);function c(e){let{text:t,className:o}=e,[c,u]=(0,a.useState)(!1),d=(0,a.useRef)(null),m=(0,a.useRef)(0),[p,v]=(0,a.useState)(42),g=p>42;return((0,a.useLayoutEffect)(()=>{var e;v((null==(e=d.current)?void 0:e.scrollHeight)||0)},[t]),t)?(0,s.jsxs)("div",{className:(0,r.A)("overflow-hidden relative transition-[height] duration-150 ease-in-out","text-text-300 text-sm",o),style:{height:c?p+32*!!g:40},children:[(0,s.jsx)("div",{ref:d,className:"whitespace-pre-wrap",style:{wordBreak:"break-word",overflowWrap:"anywhere"},children:t}),g&&(0,s.jsx)("div",{className:"absolute bottom-0 right-0 bg-bg-100 bottom-0",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute top-0 bottom-0 -left-4 w-6 bg-gradient-to-r from-transparent to-bg-100"}),(0,s.jsx)(l.$,{size:"inline",variant:"ghost",onClick:()=>{var e;let t=null==(e=d.current)?void 0:e.closest(".overflow-y-auto");!c&&t?m.current=t.scrollTop:c&&t&&t.scrollTo({top:m.current,behavior:"instant"}),u(e=>!e)},className:"font-medium flex gap-1 items-center",children:c?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.Z,{size:12,weight:"bold"}),(0,s.jsx)(i.A,{defaultMessage:"Less",id:"mFYgAXM/x4"})]}):(0,s.jsx)(i.A,{defaultMessage:"{ellipsis}More",id:"eRW5dl5m34",values:{ellipsis:"..."}})})]})})]}):null}},92947:(e,t,o)=>{o.d(t,{$V:()=>w,vx:()=>C,kX:()=>_,QD:()=>j,HJ:()=>S,sb:()=>y,BN:()=>R,M8:()=>A,ko:()=>x,AY:()=>T,es:()=>k}),o(98878);var s=o(68096),l=o(7726),n=o(98518),r=o(1761),a=o(65631),i=o(27062),c=o(90119),u=o(62942),d=o(7620),m=o(20878),p=o(57383),v=o(93770),g=o(21036),f=o(75973),h=o(62370);o(45078);var b=o(91768);let y=()=>{let{value:e}=(0,i.fS)("bagel_enabled");return e},S=()=>{let{value:e}=(0,i.fS)("inline_tool_approval");return e},C=()=>{let{account:e,activeOrganization:t}=(0,r.YL)(),o=(0,r.mV)(),s=(0,a.pG)(e,t,"claude-ai"),l=(0,a.yI)(e,t,a.Nt.IntegrationsManage);return!o||s||l},_=()=>{let e=(0,r.zm)(),t=C();return e&&!t},w="mcp_directory_chin",x=function(){var e,t;let{shouldTrack:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,d.useRef)(!1),l=y(),{dismiss:n}=(0,m.W)(),{account:a}=(0,r.YL)(),i=_(),c=new Date,u="".concat(c.getDate(),"-").concat(c.getMonth(),"-").concat(c.getFullYear()),p="".concat(w,"_").concat(u),v=(null!=(t=null==a||null==(e=a.settings.dismissed_claudeai_banners)?void 0:e.map(e=>e.banner_id))?t:[]).filter(e=>e.includes(w)),g=(0,d.useMemo)(()=>!(!l||i||v.includes(w))&&(!(v.length>3)||!v.includes(p)),[i,l,v,p]);return(0,d.useEffect)(()=>{!s.current&&g&&!v.includes(p)&&o&&(n(p),s.current=!0)},[p,v,o,n,g]),g},R=()=>{var e;let{getMcpToolApprovalRequestSetting:t}=function(){let{value:e}=(0,g.useDynamicConfig)("mcp_tool_approval_config"),t=(0,d.useCallback)((t,o)=>{var s,l,n,r;if(e){if((null==(s=e[t])?void 0:s[o])!==void 0)return e[t][o];if((null==(l=e[t])?void 0:l["*"])!==void 0)return e[t]["*"];if((null==(n=e["*"])?void 0:n[o])!==void 0)return e["*"][o];if((null==(r=e["*"])?void 0:r["*"])!==void 0)return e["*"]["*"]}},[e]);return{toolApprovalConfig:e,getMcpToolApprovalRequestSetting:t}}(),{account:o}=(0,r.YL)(),s=null==o||null==(e=o.settings)?void 0:e.enabled_mcp_tools,l=(0,d.useRef)(s);return(0,d.useEffect)(()=>{l.current=s},[s]),{getApprovalSetting:(0,d.useCallback)((e,o)=>{var s,n;let r=t(null!=e?e:"",null!=(s=null==o?void 0:o.name)?s:""),a=o?(null!=(n=l.current)?n:{})[o.alwaysApprovedKey]:void 0;return"perChat"===r||"always"===r?"always":a?"never":!1===a?"ask":null!=r?r:"ask"},[t])}},j=function(){let{pathname:e,queryString:t=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{activeOrganization:o}=(0,r.YL)(),s=(0,u.usePathname)(),l=(0,u.useSearchParams)(),a=(0,c.V)(),{track:d}=(0,n.st)();(0,i.fS)("claudeai_beam").value;let m="".concat("").concat((0,b.dH)({pathname:e||s,searchParams:l,queryString:t,isClaudeApp:a}));return e=>{let{uuid:t,url:s}=e;d({event_key:"claudeai.mcp.auth.init",uuid:t,url:s}),window.location.href="/api/organizations/".concat(null==o?void 0:o.uuid,"/mcp/start-auth/").concat(t,"?redirect_url=").concat(encodeURIComponent(m),"&open_in_browser=1")}},T=()=>{let e=(0,h.Uz)({type:"local"});return!!(0,c.V)()&&e.length>0},A=()=>{var e,t,o;let s=(0,p.oM)(),l=(null==(e=s.pendingConversationSettings)?void 0:e.compass_mode)==="advanced"||(null==(o=s.conversation)||null==(t=o.conversationSettings)?void 0:t.compass_mode)==="advanced",n=(0,h.Uz)({type:"remote"}).length>0;return l&&n},k=()=>{let e=(0,v.jw)(),{account:t}=(0,r.YL)(),{isInBeam:o,beamConversationSettings:a,setBeamConversationSettings:i}=(0,f.d)(),{track:c}=(0,n.st)(),{mutate:u}=(0,s.Jy)(),{mutate:d}=(0,l.HF)(null==e?void 0:e.id);return{toggleMcpToolEnabled:(s,l,n)=>{if(!t)return;let r=Array.isArray(s)?s.reduce((e,t)=>({...e,[t]:l}),{}):{[s]:l};if(e){var m;d({settings:{enabled_mcp_tools:{...null==(m=e.conversationSettings)?void 0:m.enabled_mcp_tools,...r}}})}else o&&i&&i({...a,enabled_mcp_tools:{...(null==a?void 0:a.enabled_mcp_tools)||{},...r}});let p=t.settings.enabled_mcp_tools;u({...t.settings,enabled_mcp_tools:{...p,...r}}),c({event_key:"claudeai.mcp.tool.toggled",conversation_uuid:(null==e?void 0:e.id)||null,setting:s,value:l,url:n})},toggleMcpToolAlwaysApproved:(e,o)=>{if(!t)return;let s=t.settings.enabled_mcp_tools;u({...t.settings,enabled_mcp_tools:{...s,[e]:o}})}}}},97349:(e,t,o)=>{o.d(t,{D:()=>l,I:()=>s});let s=e=>"".concat(e,"-wrapped"),l=e=>({remoteServers:{},remoteConnectionStates:{},remoteClients:{},remoteTools:{},remotePrompts:{},remoteResources:{},remoteIsLoading:!1,addRemoteServer:t=>e(e=>({remoteServers:{...e.remoteServers,[t.uuid]:t},remoteConnectionStates:{...e.remoteConnectionStates,[t.uuid]:{isConnected:!1,isConnecting:!0,usedAuthentication:!1}}})),setRemoteServerConnected:(t,o)=>e(e=>({...e,remoteConnectionStates:{...e.remoteConnectionStates,[t]:{isConnected:!0,isConnecting:!1,usedAuthentication:o}}})),setRemoteClient:(t,o)=>e(e=>({remoteClients:{...e.remoteClients,[t]:o}})),disconnectRemoteServer:t=>e(e=>{let{[t]:o,[s(t)]:l,...n}=e.remoteClients,{[t]:r,...a}=e.remoteTools,{[t]:i,...c}=e.remotePrompts,{[t]:u,...d}=e.remoteResources;return{...e,remoteConnectionStates:{...e.remoteConnectionStates,[t]:{isConnected:!1,isConnecting:!1,usedAuthentication:!1}},remoteClients:n,remoteTools:a,remotePrompts:c,remoteResources:d}}),removeRemoteServer:t=>e(e=>{let{[t]:o,...l}=e.remoteServers,{[t]:n,...r}=e.remoteConnectionStates,{[t]:a,[s(t)]:i,...c}=e.remoteClients,{[t]:u,...d}=e.remoteTools,{[t]:m,...p}=e.remotePrompts,{[t]:v,...g}=e.remoteResources;return{...e,remoteServers:l,remoteConnectionStates:r,remoteClients:c,remoteTools:d,remotePrompts:p,remoteResources:g}}),setRemoteTools:(t,o)=>e(e=>({remoteTools:{...e.remoteTools,[t]:o}})),setRemotePrompts:(t,o)=>e(e=>({remotePrompts:{...e.remotePrompts,[t]:o}})),setRemoteResources:(t,o)=>e(e=>({remoteResources:{...e.remoteResources,[t]:o}})),setRemoteIsLoading:t=>e({remoteIsLoading:t})})}}]);